<app-navbar></app-navbar>
<div class="container-fluid mt-5">
    <div class="row">
        <div class="col-md-5">
            <div class="carousel slide" data-bs-ride="carousel" id="carousel-1">
                <div class="carousel-inner" role="listbox">
                    <div class="carousel-item active"><img class="img-thumbnail w-100 d-block"
                            src="../../assets/images/org-picture.jpg" alt="Slide Image"
                            loading="lazy"></div>
                </div>
                <div>
                    <!-- <button class="carousel-control-prev" href="#carousel-1" role="button" data-bs-slide="prev">
                        <span class="carousel-control-prev-icon"></span>
                        <span class="sr-only">Previous</span>
                 </button>
                    <button class="carousel-control-next" href="#carousel-1" role="button" data-bs-slide="next">
                        <span class="carousel-control-next-icon"></span>
                        <span class="sr-only">Next</span>
                </button> -->
                </div>
                <!-- <ol class="carousel-indicators">
                    <li data-bs-target="#carousel-1" data-bs-slide-to="0" class="active"></li>
                    <li data-bs-target="#carousel-1" data-bs-slide-to="1"></li>
                    <li data-bs-target="#carousel-1" data-bs-slide-to="2"></li>
                </ol> -->
            </div>
        </div>
        <div class="col-md-7">
            <h1 style="color: #000066;"><b>{{currentOrg.orgName}}</b></h1>
            <div class="price" style="margin-bottom: 0.5rem;"><span class="me-2"><i class="fa fa-envelope"></i>
                    {{currentOrg.email}}</span></div>
            <div class="d-flex flex-row">
                <div class="icons me-2">
                    <ng-template #t let-fill="fill">
                        <span class="star" [class.full]="fill === 100">
                          <span class="half" [style.width.%]="fill">&hearts;</span>&hearts;
                        </span>
                      </ng-template>
                    <ngb-rating [(rate)]="orgRating" [starTemplate]="t" [readonly]="readonly" [max]="5"></ngb-rating>
                </div>
                <span>{{ratingsCount}} ratings &amp; {{commentsCount}} reviews</span>
            </div>
            <div class="d-flex flex-row light-weight" style="margin-top: 1rem; font-size:medium;">
                <p>{{currentOrg.description}}</p>
            </div>
            <div class="d-flex align-items-center mt-4 offers mb-1"><i class="fa fa-check-square-o mt-1"></i><span
                    class="ms-1 fw-bold"><b>Phone</b> {{currentOrg.phone}}</span></div>
            <div class="d-flex align-items-center offers mb-1"><i class="fa fa-check-square-o mt-1"></i><span
                    class="ms-1 fw-bold"><b>Started at</b> {{currentOrg.startDateString}}</span></div>
            <div class="d-flex align-items-center offers mb-1"><i class="fa fa-check-square-o mt-1"></i><span
                    class="ms-1 fw-bold"><b>Donations account</b> {{currentOrg.payPalAccount}}</span></div>
            <div class="d-flex align-items-center mt-5 delivery"><i class="fa-solid fa-location-dot"></i><span class="ms-1">    {{currentOrg.address}}</span>
            </div>
            <hr><br><br><br>
            <!-- <div class="d-flex align-items-center mt-2"> <label class="radio"> <input type="radio" name="ram" value="128GB" checked> <span>128GB</span> </label> <label class="radio"> <input type="radio" name="ram" value="256GB"> <span>256GB</span> </label> <label class="radio"> <input type="radio" name="ram" value="256GB"> <span>512GB</span> </label> </div>
            <div class="mt-3"><span class="fw-bold">Seller:</span><span class="ms-2">Therichpost.com</span></div>
            <div class="mt-3"><button class="btn btn-dark me-2" type="button">ADD TO CART</button><button class="btn btn-success" type="button">BUY NOW</button></div> -->
        </div>
    </div>
    <div class="row" style="margin-left: 0.5rem;">
    </div>
    <div class="row justify-content-center" style="margin-left: 0.5rem; margin-top: 1rem;">
        <h3 style="color: #663300;"><b>Animals</b></h3><br>
    </div>
    <div *ngIf="allAnimals.length > 0" class="row justify-content-center" style="margin-left: 1rem; ">
        <div *ngFor="let animal of allAnimals" class="card" style="width: 18rem; margin-right: 1rem; margin-top: 1rem; margin-bottom: 1rem;">
          <img *ngIf="picturesFilePaths.length > 0"
              src="../../assets/images/{{animal.id}}/{{picturesFilePaths[0]}}"
              class="card-img-top"
              alt="..."
            />
            <img *ngIf="picturesFilePaths.length == 0 && animal.type=='dog'"
              src="../../assets/images/bernese-mountain.png"
              class="card-img-top"
              alt="..."
            />
            <img *ngIf="picturesFilePaths.length == 0 && animal.type=='cat'"
              src="../../assets/images/birman-cat.png"
              class="card-img-top"
              alt="..."
            />
          <div class="card-body" style="padding-bottom: 8px !important;">
              <p class="card-text">
              <b>{{animal.name}}</b>, <i *ngIf="animal.gender == 'male'" class="fa-solid fa-mars"></i><i *ngIf="animal.gender == 'female'" class="fa-solid fa-venus"></i>, {{animal.age}}
              </p>
               <p>{{animal.description}}</p>
              <!-- <p style="font-size:x-small;">Vaccinated: {{animal.vaccinated}}</p>
              <p style="font-size:x-small;">Sterilised: {{animal.sterilised}}</p>
              <p style="font-size:x-small;">Special treatment: {{animal.specialTreatment}}</p> -->
              <button type="button" mdbBtn  color="deep-orange" size="sm" (click)="goToAnimalDetail(animal.id)" style="float: right;">View more info</button>
          </div>
      </div>
      <div *ngIf="allAnimals.length == 0">
        <p>You do not have animals listed. You can create your animals profiles from your account.</p>
    </div>
        
    </div><br>
    <div class="row justify-content-center" style="margin-left: 0.5rem; margin-top: 0.5rem;"><br>
        <h2 style="margin-bottom: 4px !important; color: #3399FF; padding-left: 15px;">Please leave us some feedback!</h2>
    </div>
    <div class="row justify-content-center" style="margin-left: 0.5rem; padding-left: 15px;">
        <h5>If you want to send us some good words or rate us based on our activity, complete the following form! This will increase our confidence!</h5>
    </div>
    <div class="row d-flex justify-content-center" style="margin-left: 0.5rem; margin-top: 0.5rem;">
        <div class="col-10 d-flex justify-content-center">
        <form *ngIf="currentUser != null" [formGroup]="rateForm" >
            <div class="text-dark">
                <div class="row d-flex">
                  <div class="col-lg-7" style="float: left; height: 275px; width: 725px;">
                    <div class="card">
                      <div class="card-body p-4" style="padding-bottom: 0.5rem !important; padding-left: 1rem !important; padding-top: 1rem !important;">
                        <div class="d-flex flex-start w-100">
                          <img class="rounded-circle shadow-1-strong me-3"
                            src="../../assets/images/userAdmin.png" alt="avatar" width="65"
                            height="65" />
                          <div class="w-100" style="margin-left: 0.5rem;">
                            <h1 style="margin: 0 !important; padding-bottom: 0.3rem !important; padding-left: 0.5rem !important;">Add a comment or rating</h1>
                            <div style="padding-bottom: 0.75rem;"><ngb-rating  style="padding-left: 0.5rem; font-size: 1.5rem;" formControlName="rating" [(rate)]="currentRate" [max]="5"></ngb-rating></div>
                             <!-- <div style="float: left;">Your rating is {{rateForm.value.rating}} stars</div><br><br> -->
                            <!-- <ul class="rating" data-mdb-toggle="rating">
                                  <i class="far fa-star fa-sm text-primary" title="Bad"></i>
                                  <i class="far fa-star fa-sm text-primary" title="Poor"></i>
                                  <i class="far fa-star fa-sm text-primary" title="OK"></i>
                                  <i class="far fa-star fa-sm text-primary" title="Good"></i>
                                  <i class="far fa-star fa-sm text-primary" title="Excellent"></i>
                              </ul> -->
                            <div class="form-outline">
                              <textarea class="form-control" formControlName="comment" id="textAreaExample" rows="3" placeholder="Type a comment..."></textarea>
                              <small class="text-danger" *ngIf="displayErrorMessage == true">There was an error. Please try again!</small>
                            </div>
                            <div class="d-flex mt-3" style="float: right;">
                              <button type="button" class="btn btn-danger btn-md" (click)="postFeedback()">
                                Send <i class="fas fa-long-arrow-alt-right ms-1"></i>
                              </button>
                            </div>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            <!-- <div class="row" style="float: left;"><ngx-star-rating formControlName="rating" [id]="'rating'"></ngx-star-rating></div><br><br><br>
            <div style="float: left;">Your rating is {{rateForm.value.rating}} stars</div><br><br> -->
        </form>
        <div class="col-md-8 col-lg-5 justify-content-center" style="padding-left: 0rem !important; margin-bottom: 1rem; "> 
            <div *ngIf="currentUser == null" class="alert alert-warning" role="alert">You must be logged in to be able to comment!</div>
            <div class="card shadow-0 border" style="background-color: #f0f2f5;">
            <div class="card-body p-4">
              <div *ngIf="allFeedbacksWithComments.length > 0">
                <div *ngFor="let feedback of allFeedbacksWithComments; let last = last" class="card mb-4">
                  <div class="card-body">
                    <p>{{feedback.comment}}</p>
        
                    <div class="d-flex justify-content-between">
                      <div class="d-flex flex-row align-items-center">
                        <img src="../../assets/images/comment-user.png" alt="avatar" width="25"
                        height="25" />
                        <p class="small mb-0 ms-2" style="padding-left: 0.3rem;">{{feedback.user.firstName}} {{feedback.user.lastName}}</p>
                      </div>
                      <div class="d-flex flex-row align-items-center justify-content-center">
                        <ngb-rating *ngIf="feedback.rating != 0 && feedback.rating != null" [(rate)]="feedback.rating" [readonly]="readonly" [max]="5"></ngb-rating>
                        <i class="far fa-clock mx-2 fa-xs text-black" style="margin-top: -0.16rem;"></i>
                        <p class="small text-muted mb-0">{{feedback.createdDateString}}</p>
                      </div>
                    </div>
                  </div>
                </div>
                </div>
                <div *ngIf="allFeedbacksWithComments.length == 0">
                  <p>There is no comment yet for this organization. You can add one to help this organization grow!</p>
                </div>
            </div>
            </div>
        </div>
    </div>
    </div>
    
</div>